
*&---------------------------------------------------------------------*
*& Report Z07_SC_CS
*&---------------------------------------------------------------------*
*&
*&---------------------------------------------------------------------*
REPORT Z12_CASE2.

TABLES SSCRFIELDS.
*TABLES: Z12_COMM, Z12_AT,
*        Z12_COURSE,  Z12_IA,
*        Z12_INSTRUCTOR, Z12_STEN,
*        Z12_STUDENT, Z12_TRAIN.

TYPES: BEGIN OF FP,
       FNAME TYPE DFIES-FIELDNAME,
       END OF FP.
TYPES: BEGIN OF A1,
       FF TYPE C LENGTH 500,
       END OF A1.
DATA: F1 TYPE TABLE OF DFIES.

DATA: FNTAB TYPE TABLE OF FP,
       FS TYPE FP.
DATA: ITALV TYPE TABLE OF A1,
              WAALV TYPE A1.



FIELD-SYMBOLS: <FST> TYPE ANY TABLE,
                 <FSW> TYPE ANY,
                 <FSCOL> TYPE ANY,
                 <FTNAME> TYPE STANDARD TABLE.

DATA: ITAB TYPE REF TO DATA,
        WA TYPE REF TO DATA,
        TNAME TYPE C LENGTH 30,
        N1 TYPE N.
DATA: T1 TYPE TRUXS_T_TEXT_DATA.

*SELECTION-SCREEN BEGIN OF SCREEN 1001.
SELECTION-SCREEN BEGIN OF BLOCK B1.
  PARAMETERS: UPLOAD RADIOBUTTON GROUP G2,
              DOWNLOAD RADIOBUTTON GROUP G2.
  SELECTION-SCREEN SKIP.
  SELECTION-SCREEN BEGIN OF LINE.
  SELECTION-SCREEN PUSHBUTTON 4(10) text-001 USER-COMMAND NEXT.
  SELECTION-SCREEN PUSHBUTTON 45(20) TEXT-002 USER-COMMAND EXIT.
  SELECTION-SCREEN END OF LINE.
  SELECTION-SCREEN END OF BLOCK B1.


SELECTION-SCREEN BEGIN OF SCREEN 1001.
  SELECTION-SCREEN BEGIN OF BLOCK B2.
SELECTION-SCREEN BEGIN OF LINE.
  SELECTION-SCREEN COMMENT 1(20) TEXT-111.
  SELECTION-SCREEN END OF LINE.
SELECTION-SCREEN SKIP.
SELECTION-SCREEN BEGIN OF LINE.
  SELECTION-SCREEN POSITION 1.
  PARAMETERS R1 RADIOBUTTON GROUP G1.
  SELECTION-SCREEN COMMENT 4(20) TEXT-AAA.
SELECTION-SCREEN PUSHBUTTON 45(50) TEXT-003 USER-COMMAND STUDENT.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
 PARAMETERS R2 RADIOBUTTON GROUP G1.
 SELECTION-SCREEN COMMENT 4(20) TEXT-BBB.
 SELECTION-SCREEN PUSHBUTTON 45(50) TEXT-004 USER-COMMAND INSTRUCTOR.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
 PARAMETERS R3 RADIOBUTTON GROUP G1.
 SELECTION-SCREEN COMMENT 4(20) TEXT-CCC.
 SELECTION-SCREEN PUSHBUTTON 45(50) TEXT-005 USER-COMMAND COMMUNICATION.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
 PARAMETERS R4 RADIOBUTTON GROUP G1.
 SELECTION-SCREEN COMMENT 4(20) TEXT-DDD.
 SELECTION-SCREEN PUSHBUTTON 45(50) TEXT-006 USER-COMMAND COURSES.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
 PARAMETERS R5 RADIOBUTTON GROUP G1.
 SELECTION-SCREEN COMMENT 4(20) TEXT-EEE.
 SELECTION-SCREEN PUSHBUTTON 45(50) TEXT-007 USER-COMMAND TRAINING.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
 PARAMETERS R6 RADIOBUTTON GROUP G1.
 SELECTION-SCREEN COMMENT 4(20) TEXT-FFF.
 SELECTION-SCREEN PUSHBUTTON 45(50) TEXT-008 USER-COMMAND STUDENTENROLL.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
 PARAMETERS R7 RADIOBUTTON GROUP G1.
 SELECTION-SCREEN COMMENT 4(20) TEXT-GGG.
 SELECTION-SCREEN PUSHBUTTON 45(50) TEXT-009 USER-COMMAND INSTRUCTORALLOT.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN BEGIN OF LINE.
 PARAMETERS R8 RADIOBUTTON GROUP G1.
 SELECTION-SCREEN COMMENT 4(20) TEXT-HHH.
 SELECTION-SCREEN PUSHBUTTON 45(50) TEXT-010 USER-COMMAND ATTENDANCE.
SELECTION-SCREEN END OF LINE.

SELECTION-SCREEN SKIP.
  PARAMETERS CH AS CHECKBOX USER-COMMAND READY.
SELECTION-SCREEN SKIP 2.
  PARAMETERS FILENAME TYPE RLGRAP-filename MODIF ID T2.
  SELECTION-SCREEN SKIP.
 SELECTION-SCREEN PUSHBUTTON 70(20) TEXT-011 USER-COMMAND VALIDATE MODIF ID T1.
 SELECTION-SCREEN END OF BLOCK B2.
    SELECTION-SCREEN END OF SCREEN 1001.

    AT SELECTION-SCREEN OUTPUT.
      IF CH <> 'X'.
  LOOP AT SCREEN.
      IF screen-GROUP1 = 'T1' OR SCREEN-GROUP1 = 'T2'.
        screen-invisible = 1.
      ENDIF.
    MODIFY SCREEN .
    ENDLOOP.
    ENDIF.
AT SELECTION-SCREEN ON BLOCK B1.
      CASE SSCRFIELDS-UCOMM.
        WHEN 'NEXT'.
          CALL SELECTION-SCREEN 1001.
          WHEN 'EXIT'.
            LEAVE PROGRAM.
            ENDCASE.
AT SELECTION-SCREEN ON BLOCK B2.

  IF SSCRFIELDS-UCOMM EQ 'STUDENT'  AND R1 = 'X'.
    TNAME = 'Z12_STUDENT'.
  CREATE DATA ITAB TYPE TABLE OF (TNAME).
 ASSIGN ITAB->* TO <FTNAME>.
  CREATE DATA WA TYPE (TNAME).
  PERFORM STUDENTDN.

  ELSEif SSCRFIELDS-UCOMM EQ 'INSTRUCTOR' AND R2 = 'X'.
  TNAME = 'Z12_INSTRUCTOR'.
  CREATE DATA ITAB TYPE TABLE OF (TNAME).
  ASSIGN ITAB->* TO <FTNAME>.
  CREATE DATA WA TYPE (TNAME).
  PERFORM INSTRUCTORDN.

   ELSEif SSCRFIELDS-UCOMM EQ 'COMMUNICATION' AND R3 = 'X'.
    TNAME = 'Z12_COMM'.
  CREATE DATA ITAB TYPE TABLE OF (TNAME).
   ASSIGN ITAB->* TO <FTNAME>.
  CREATE DATA WA TYPE (TNAME).
  PERFORM COMMUNICATIONDN.
  ELSEif SSCRFIELDS-UCOMM EQ 'COURSES' AND R4 = 'X'.
    TNAME = 'Z12_COURSE'.
  CREATE DATA ITAB TYPE TABLE OF (TNAME).
 ASSIGN ITAB->* TO <FTNAME>.
  CREATE DATA WA TYPE (TNAME).
  PERFORM COURSESDN.

  ELSEif SSCRFIELDS-UCOMM EQ 'TRAINING' AND R5 = 'X'.
     TNAME = 'Z12_TRAIN'.
  CREATE DATA ITAB TYPE TABLE OF (TNAME).
   ASSIGN ITAB->* TO <FTNAME>.
  CREATE DATA WA TYPE (TNAME).
  PERFORM TRAININGDN.
  ELSEif SSCRFIELDS-UCOMM EQ 'STUDENTENROLL' AND R6 = 'X'.
   TNAME = 'Z12_STEN'.
  CREATE DATA ITAB TYPE TABLE OF (TNAME).
   ASSIGN ITAB->* TO <FTNAME>.
  CREATE DATA WA TYPE (TNAME).
   PERFORM STUDENTENROLLDN.

  ELSEif SSCRFIELDS-UCOMM EQ 'INSTRUCTORALLOT' AND R7 = 'X'.
     TNAME = 'Z12_IA'.
  CREATE DATA ITAB TYPE TABLE OF (TNAME).
   ASSIGN ITAB->* TO <FTNAME>.
  CREATE DATA WA TYPE (TNAME).
   PERFORM INSTRUCTORALLOTMENTDN.

  ELSEif SSCRFIELDS-UCOMM EQ 'ATTENDANCE' AND R8 = 'X'.
    TNAME = 'Z12_AT'.
  CREATE DATA ITAB TYPE TABLE OF (TNAME).
   ASSIGN ITAB->* TO <FTNAME>.
  CREATE DATA WA TYPE (TNAME).
   PERFORM ATTENDANCEDN.

   ELSEIF SSCRFIELDS-UCOMM EQ 'VALIDATE' AND R1 = 'X' .
  TNAME = 'Z12_STUDENT'.
  CREATE DATA ITAB TYPE TABLE OF (TNAME).
 ASSIGN ITAB->* TO <FTNAME>.
  CREATE DATA WA TYPE (TNAME).
  PERFORM STUDENT.

elseIF SSCRFIELDS-UCOMM EQ 'VALIDATE' AND R2 = 'X'.
  TNAME = 'Z12_INSTRUCTOR'.
  CREATE DATA ITAB TYPE TABLE OF (TNAME).
  ASSIGN ITAB->* TO <FTNAME>.
  CREATE DATA WA TYPE (TNAME).
  PERFORM INSTRUCTOR.

elseif SSCRFIELDS-UCOMM EQ 'VALIDATE' AND
    R3 = 'X'.
  TNAME = 'Z12_COMM'.
  CREATE DATA ITAB TYPE TABLE OF (TNAME).
   ASSIGN ITAB->* TO <FTNAME>.
  CREATE DATA WA TYPE (TNAME).
  PERFORM COMMUNICATION.


  elseif SSCRFIELDS-UCOMM EQ 'VALIDATE' AND
  R4 = 'X'.
  TNAME = 'Z12_COURSE'.
  CREATE DATA ITAB TYPE TABLE OF (TNAME).
 ASSIGN ITAB->* TO <FTNAME>.
  CREATE DATA WA TYPE (TNAME).
  PERFORM COURSES.


  elseif SSCRFIELDS-UCOMM EQ 'VALIDATE' AND
     R5 = 'X'.
  TNAME = 'Z12_TRAIN'.
  CREATE DATA ITAB TYPE TABLE OF (TNAME).
   ASSIGN ITAB->* TO <FTNAME>.
  CREATE DATA WA TYPE (TNAME).
  PERFORM TRAINING.


  elseif SSCRFIELDS-UCOMM EQ 'VALIDATE' AND
 R6 = 'X'.
  TNAME = 'Z12_STEN'.
  CREATE DATA ITAB TYPE TABLE OF (TNAME).
   ASSIGN ITAB->* TO <FTNAME>.
  CREATE DATA WA TYPE (TNAME).
   PERFORM STUDENTENROLL.

  elseif SSCRFIELDS-UCOMM EQ 'VALIDATE' AND
    R7 = 'X'.
  TNAME = 'Z12_IA'.
  CREATE DATA ITAB TYPE TABLE OF (TNAME).
   ASSIGN ITAB->* TO <FTNAME>.
  CREATE DATA WA TYPE (TNAME).
   PERFORM INSTRUCTORALLOTMENT.

  elseif SSCRFIELDS-UCOMM EQ 'VALIDATE' AND
 R8 = 'X'.
  TNAME = 'Z12_AT'.
  CREATE DATA ITAB TYPE TABLE OF (TNAME).
   ASSIGN ITAB->* TO <FTNAME>.
  CREATE DATA WA TYPE (TNAME).
   PERFORM ATTENDANCE.
  ENDIF.


AT SELECTION-SCREEN ON VALUE-REQUEST FOR FILENAME.
  CALL FUNCTION 'F4_FILENAME'
   EXPORTING
     PROGRAM_NAME        = SYST-CPROG
*     DYNPRO_NUMBER       = SYST-DYNNR
     FIELD_NAME          = 'FILENAME'
   IMPORTING
     FILE_NAME           = FILENAME.


  START-OF-SELECTION.

INCLUDE Z12_DATAUP.

INCLUDE Z12_DWN.
